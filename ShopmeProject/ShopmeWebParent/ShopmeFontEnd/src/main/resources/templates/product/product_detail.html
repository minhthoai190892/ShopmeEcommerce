<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments::page_head(${pageTitle},'none')"> </head>

<body>
	<div class="container-fluid">
		<!-- menu -->
		<div th:replace="navigation::head_menu"> </div>
		<!-- serach -->
		<div th:replace="navigation::search_nav"> </div>
		<!-- breadcrumb -->
		<div th:replace="breadcrumb::content"> </div>

		<!-- breadcrumb -->
		<!-- Detail -->
		<div class="row">
			<!-- main image -->
			<div class="col-sm">
				<div>
					<img id="bigImage" th:src="@{${product.mainImagePath}}" style="width: 500px;height: 300px;"
						class="img-fluid" />
				</div>
				<!-- extra image -->
				<div class="row mt-2 d-flex justify-content-center">
					<div>
						<img class="image-thumbnail border" th:src="@{${product.mainImagePath}}" height="50" />
						<!-- lấy từ field images trong product -->
						<th:block th:each="extraImage:${product.images}">
							<!-- enlarge thumbnail on mouse over -->
							<img class="image-thumbnail border" th:src="@{${extraImage.imagePath}}" height="50" />

						</th:block>
					</div>

				</div>
			</div>
			<!-- thông tin sản phẩm -->
			<div class="col-sm">
				<div>
					<h2>[[${product.name}]]</h2>
				</div>
				<div>
					<span>Brand: [[${product.brand.name}]]</span>
				</div>
				<div>
					List Price:
					<span th:if="${product.discountPercent<=0}"><span
							th:replace="/product/product_fragment::price_fragment(${product.discountPrice})"></span></span>
					<del><span
							th:replace="/product/product_fragment::price_fragment(${product.discountPrice})"></span></del>
				</div>
				<div th:if="${product.discountPercent>0}">
					<span style="font-size: larger; color:darkred ;"><span
							th:replace="/product/product_fragment::price_fragment(${product.discountPrice})"></span></span>
					([[${#numbers.formatDecimal(product.discountPercent,1,THOUSANDS_POINT_TYPE,DECIMAL_DIGITS,DECIMAL_POINT_TYPE)}]]
					% off)

				</div>
				<br>
				<div th:utext="${product.shortDescription}"></div>
			</div>
			<!-- thông tin sản phẩm -->
			<!-- In Stock -->
			<div class="col-sm-2">
				<div>
					<span th:if="${product.inStock}" class="text-success"><b>In Stock</b></span>
					<span th:unless="${product.inStock}" class="text-danger"><b>Out of Stock</b></span>
				</div>
				<th:block th:if="${product.inStock}">
					<span th:value="${product.inStock}"></span>
					<div th:replace="cart/quantity_control::quantity_control(1,${product.id})"></div>
					<div class="mt-3"><input type="button" value="Add to cart" id="buttonAdd2Cart"
							class="btn btn-primary" /></div>
				</th:block>
			</div>
			<!-- In Stock -->
		</div>
		<!-- Decription -->
		<div class="row">
			<div class="col-12">
				<hr>
				<div>
					<h3>Product Decription: </h3>
				</div>
				<div th:utext="${product.fullDescription}"></div>
			</div>
		</div>
		<!-- Decription -->
		<!--  -->
		<div class="row">
			<div class="col-12">
				<hr>
				<div>
					<h3>Product Details: </h3>
				</div>
				<th:block th:each="detail:${product.details}">
					<div>
						<b>[[${detail.name}]]</b>
						<span>[[${detail.value}]]</span>
					</div>
				</th:block>
			</div>
		</div>
		<!-- Modal -->
		<div th:replace="fragments::modal_dialog"></div>


		<!-- Detail -->
	</div>
	<div th:replace="product/images_carousel::content"></div>
	<div th:replace="navigation::footer_menu"></div>

	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
		integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous">
		</script>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js"
		integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz" crossorigin="anonymous">
		</script>
	<script src=https://code.jquery.com/jquery-3.6.0.min.js></script>
	<script th:src="@{/js/quantity_control.js}"></script>
	<script th:src="@{/js/common_modal.js}"></script>

	<script type="text/javascript">
		contextPath = "[[@{/}]]";
		productId = "[[${product.id}]]";
		var csrfHeaderName = "[[${_csrf.headerName}]]";
		var csrfValue = "[[${_csrf.token}]]"
		console.log(productId + "\n" + contextPath);
		$(document).ready(function () {
			bigImage = $("#bigImage");
			//thêm sự kiện
			$(".image-thumbnail").mousemove(function () {
				//lấy đường dẫn extra image (".image-thumbnail")
				currentImageSource = $(this).attr("src");
				//thây đổi hình ảnh
				bigImage.attr("src", currentImageSource);
			});
			bigImage.on("click", function () {
				//lấy id của modal trong images_carousel.html
				$("#carouselModal").modal("show");
			})
		});
	</script>
	<script th:src="@{/js/add_to_cart.js}"></script>
</body>

</html>